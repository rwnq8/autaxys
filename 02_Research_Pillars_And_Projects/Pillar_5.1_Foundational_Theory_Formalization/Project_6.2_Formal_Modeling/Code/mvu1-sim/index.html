<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autaxys MVU-1 Simulation</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; margin: 0; background-color: #f4f7f6; color: #333; line-height: 1.6; }
        .container { max-width: 1400px; margin: auto; padding: 20px; }
        h1, h2, h3 { color: #2c3e50; }
        .panel { background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        /* Documentation Styles */
        details { border: 1px solid #e0e0e0; border-radius: 8px; margin-bottom: 20px; }
        summary { font-weight: bold; font-size: 1.2rem; cursor: pointer; padding: 15px; background-color: #f9f9f9; border-radius: 8px 8px 0 0; }
        .docs-content { padding: 0 20px 20px 20px; }
        blockquote { border-left: 4px solid #3498db; margin-left: 0; padding-left: 15px; font-style: italic; color: #555; }
        dt { font-weight: bold; color: #34495e; }
        dd { margin-left: 20px; margin-bottom: 10px; }

        /* Control and Log Styles */
        .controls-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; align-items: flex-end; }
        .input-group { display: flex; flex-direction: column; }
        label { font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; color: #555; }
        button, input[type="number"] { font-size: 1rem; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
        button { background-color: #3498db; color: white; cursor: pointer; border: none; }
        button:hover { background-color: #2980b9; }
        button:disabled { background-color: #bdc3c7; cursor: not-allowed; }
        #stop-button { background-color: #e74c3c; }
        #stop-button:hover { background-color: #c0392b; }
        #live-log-panel { display: none; }
        #live-log-output { background-color: #2c3e50; color: #ecf0f1; font-family: 'Courier New', Courier, monospace; padding: 15px; border-radius: 5px; height: 300px; overflow-y: scroll; white-space: pre-wrap; }
        .log-error { color: #ff7675; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Autaxys MVU-1 Simulation</h1>

        <!-- NEW: On-page documentation section -->
        <details open>
            <summary>About This Simulation</summary>
            <div class="docs-content">
                <h3>What is this?</h3>
                <p>
                    This is a "digital universe in a box," a simulation of the Autaxys framework's **Minimal Viable Universe 1 (MVU-1)**. It's designed to test a fundamental idea about how reality might organize itself from a simple starting point, without any external designer or pre-existing laws.
                </p>
                <p>
                    This simulation is a key deliverable for research **Project 6.2: Formal Mathematical & Computational Modeling** of the Autaxic Generative Engine.
                </p>

                <h3>What is the Goal?</h3>
                <blockquote>
                    The core hypothesis being tested is: **Can a system governed by a simple, local optimization principle spontaneously organize itself into complex, stable structures?**
                </blockquote>
                <p>
                    Success is not defined by creating a specific final shape, but by observing whether the system, on its own, trends towards states of higher "coherence" or "stability." We measure this with a score called the Autaxic Lagrangian (`L_A`). If the `L_A` score generally increases over time, the hypothesis is supported.
                </p>

                <h3>How Does it Work? The Core Principles</h3>
                <dl>
                    <dt>Distinctions & Relations</dt>
                    <dd>The universe consists of fundamental "things" called Distinctions (nodes) and the "connections" between them called Relations (edges). This forms a graph.</dd>

                    <dt>Polarity</dt>
                    <dd>Each Distinction has a `polarity` of either `+1` or `-1`. Think of them like simple opposite charges.</dd>

                    <dt>The "Cosmic Algorithm" (The Rules)</dt>
                    <dd>The universe evolves according to three simple rewrite rules:
                        <ul>
                            <li><b>Bonding:</b> A `+1` and a `-1` Distinction that are not yet connected can form a new Relation between them.</li>
                            <li><b>Annihilation:</b> A perfectly bonded pair (`+1` and `-1` connected only to each other) can remove itself from the universe.</li>
                            <li><b>Redundancy Collapse:</b> An unstable triangle of three connected nodes simplifies itself into a single, stable bonded pair.</li>
                        </ul>
                    </dd>

                    <dt>The Autaxic Lagrangian (L_A) - The "Fitness" Score</dt>
                    <dd>The `L_A` is a score that measures how "good" the current state of the universe is. It's calculated as `(Number of bonded pairs) / (Total number of Distinctions + Relations)`. At every step, the simulation looks at all possible moves (Bonding, Annihilation, etc.) and chooses the one that will result in the **highest `L_A` score** for the next step. This is the sole driver of the system's evolution.</dd>
                </dl>
            </div>
        </details>

        <div class="panel controls">
            <h3>Simulation Controls</h3>
            <div class="controls-grid">
                <div class="input-group">
                    <label for="distinctions-input">Initial Distinctions (each polarity)</label>
                    <input type="number" id="distinctions-input" value="2" min="1">
                </div>
                <div class="input-group">
                    <label for="steps-input">Max Steps</label>
                    <input type="number" id="steps-input" value="20" min="1">
                </div>
                <button id="run-button">Start Simulation</button>
                <button id="stop-button" disabled>Stop Simulation</button>
            </div>
            <div id="status-line" style="margin-top: 15px; font-style: italic; color: #7f8c8d;"></div>
        </div>

        <div class="panel" id="live-log-panel">
            <h3>Live Simulation Log</h3>
            <div id="live-log-output"></div>
        </div>
        
        <div class="panel summary" id="summary-panel" style="display:none;">
            <h3>Final State Summary</h3>
            <pre id="summary-text"></pre>
        </div>

        <div id="results-section" style="display:none;">
            <!-- Chart canvases will be added here by main.ts -->
        </div>

        <div class="panel" id="download-panel" style="display:none;">
            <button id="download-csv">Download Results (.csv)</button>
        </div>

    </div>
    <script type="module" src="main.ts"></script>
</body>
</html>
